package pl.ciruk.films.whattowatch.score.metacritic;

import com.google.common.base.Charsets;
import org.jsoup.nodes.Element;
import pl.ciruk.core.cache.CacheProvider;
import pl.ciruk.core.net.JsoupCachedConnection;
import pl.ciruk.core.net.JsoupConnection;
import pl.ciruk.core.text.MissingValueException;
import pl.ciruk.films.whattowatch.description.Description;
import pl.ciruk.films.whattowatch.score.Score;
import pl.ciruk.films.whattowatch.score.ScoresProvider;
import pl.ciruk.films.whattowatch.score.google.GoogleScores;
import pl.ciruk.films.whattowatch.title.Title;

import javax.inject.Inject;
import javax.inject.Named;
import java.io.UnsupportedEncodingException;
import java.net.URLEncoder;
import java.util.Optional;
import java.util.stream.Stream;

@Named("Metacritic")
public class MetacriticScores implements ScoresProvider {
	private static final String METACRITIC_BASE_URL = "http://www.metacritic.com";

	public static final String html = "<div class=\"body\"><ul class=\"search_results module\"> <li class=\"result first_result\"> <div class=\"result_type\"> <strong>Movie</strong> </div> <div class=\"result_wrap\"> <div class=\"basic_stats has_score\"> <div class=\"main_stats\"> <h3 class=\"product_title basic_stat\"><a href=\"/movie/zodiac\">Zodiac</a></h3> <span class=\"metascore_w medium movie positive\">78</span> </div> <div class=\"more_stats extended_stats\"> <ul class=\"more_stats\"> <li class=\"stat release_date\"> <span class=\"label\">Release Date:</span> <span class=\"data\">March 2, 2007</span> </li> <li class=\"stat rating\"> <span class=\"label\">Rated:</span> <span class=\"data\"> R </span> </li> <li class=\"stat cast\"> <span class=\"label\">Starring:</span> <span class=\"data\"> Jake Gyllenhaal, Mark Ruffalo, Robert Downey Jr. </span> </li> <li class=\"stat genre\"> <span class=\"label\">Genre(s):</span> <span class=\"data\"> Drama, Mystery, Thriller, Crime </span> </li> <li class=\"stat product_avguserscore\"> <span class=\"label\">User Score:</span> <span class=\"data textscore textscore_favorable\">7.9</span> </li> <li class=\"stat runtime\"> <span class=\"label\">Runtime:</span> <span class=\"data\">157 min</span> </li> </ul> </div> </div> <p class=\"deck basic_stat\">Based on the actual case files of one of the most intriguing unsolved crimes in the nation's history, Zodiac is a thriller from David Fincher, director of \"Seven\" and \"Fight Club.\" As a serial... </p></div> </li> <li class=\"result\"> <div class=\"result_type\"> <strong>Movie</strong> </div> <div class=\"result_wrap\"> <div class=\"basic_stats has_score\"> <div class=\"main_stats\"> <h3 class=\"product_title basic_stat\"><a href=\"/movie/the-zodiac\">The Zodiac</a></h3> <span class=\"metascore_w medium movie negative\">21</span> </div> <div class=\"more_stats extended_stats\"> <ul class=\"more_stats\"> <li class=\"stat release_date\"> <span class=\"label\">Release Date:</span> <span class=\"data\">March 17, 2006</span> </li> <li class=\"stat rating\"> <span class=\"label\">Rated:</span> <span class=\"data\"> R </span> </li> <li class=\"stat cast\"> <span class=\"label\">Starring:</span> <span class=\"data\"> Justin Chambers, Robin Tunney, Rory Culkin </span> </li> <li class=\"stat genre\"> <span class=\"label\">Genre(s):</span> <span class=\"data\"> Drama, Mystery, Thriller, Horror, Crime </span> </li> <li class=\"stat product_avguserscore\"> <span class=\"label\">User Score:</span> <span class=\"data textscore textscore_mixed\">5.0</span> </li> <li class=\"stat runtime\"> <span class=\"label\">Runtime:</span> <span class=\"data\">92 min</span> </li> </ul> </div> </div> <p class=\"deck basic_stat\">Based on true events‚ The Zodiac is a psychological thriller detailing a string of gruesome murders in the Bay Area in the late 1960s and the impact on the victims‚ their families and the wider... </p></div> </li> </ul></div>";
	
	public static final String reviews = "<div id=\"main\" class=\"col main_col\"> <div class=\"content_head product_content_head movie_content_head\"> <div class=\"product_title\"> <a href=\"/movie/zodiac\" class=\"hover_none\"> Zodiac </a> </div> <div class=\"inline_social product_social\"> <div class=\"inline_social_button\"> <iframe id=\"twitter-widget-0\" scrolling=\"no\" frameborder=\"0\" allowtransparency=\"true\" src=\"http://platform.twitter.com/widgets/tweet_button.c27d2d163408c0fe087fbfe1c687ce2b.en.html#_=1420322442778&amp;count=horizontal&amp;counturl=http%3A%2F%2Fwww.metacritic.com%2Fmovie%2Fzodiac&amp;id=twitter-widget-0&amp;lang=en&amp;original_referer=http%3A%2F%2Fwww.metacritic.com%2Fmovie%2Fzodiac%2Fcritic-reviews&amp;size=m&amp;text=Critic%20Reviews%20for%20Zodiac%20-%20Metacritic&amp;url=http%3A%2F%2Fmtcr.tc%2FlPGduI&amp;via=metacritic\" class=\"twitter-share-button twitter-tweet-button twitter-share-button twitter-count-horizontal\" title=\"Twitter Tweet Button\" data-twttr-rendered=\"true\" style=\"width: 107px; height: 20px;\"></iframe> </div> <div class=\"inline_social_button facebook_sharing\"> <noscript> &lt;a href=\"http://www.facebook.com/sharer/sharer.php?u=http://www.metacritic.com/movie/zodiac&amp;t=Critic Reviews for Zodiac\" rel=\"nofollow popup:external\"&gt; &lt;img src=\"/images/buttons/facebook_inline.png\" alt=\"Share this on Facebook\" rel=\"nofollow\" /&gt; &lt;/a&gt; </noscript> <fb:like href=\"http://www.metacritic.com/movie/zodiac\" send=\"false\" layout=\"button_count\" width=\"100\" show_faces=\"false\" font=\"\" class=\" fb_iframe_widget\" fb-xfbml-state=\"rendered\" fb-iframe-plugin-query=\"app_id=123113677890173&amp;href=http%3A%2F%2Fwww.metacritic.com%2Fmovie%2Fzodiac&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=100\"><span style=\"vertical-align: bottom; width: 76px; height: 20px;\"><iframe name=\"f30623ca18\" width=\"100px\" height=\"1000px\" frameborder=\"0\" allowtransparency=\"true\" scrolling=\"no\" title=\"fb:like Facebook Social Plugin\" src=\"http://www.facebook.com/plugins/like.php?app_id=123113677890173&amp;channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter%2F7r8gQb8MIqE.js%3Fversion%3D41%23cb%3Df2728c6e44%26domain%3Dwww.metacritic.com%26origin%3Dhttp%253A%252F%252Fwww.metacritic.com%252Ff345e1412c%26relation%3Dparent.parent&amp;href=http%3A%2F%2Fwww.metacritic.com%2Fmovie%2Fzodiac&amp;layout=button_count&amp;locale=en_US&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=100\" style=\"border: none; visibility: visible; width: 76px; height: 20px;\" class=\"\"></iframe></span></fb:like> </div> </div> <div class=\"product_data\"> <ul class=\"summary_details\"> <li class=\"summary_detail publisher\"> <span class=\"label\">Studio:</span> <span class=\"data\"> <a href=\"/company/paramount-pictures\"> Paramount Pictures </a> </span> </li> <li class=\"summary_detail release_data\"> <span class=\"label\">Release Date:</span> <span class=\"data\"> Mar 2, 2007 </span> </li> </ul> </div> </div> <div class=\"content_nav\"> <ul class=\"nav_items content_nav\"> <li class=\"nav nav_summary first_nav\"> <span class=\"nav_item\"> <span class=\"nav_item_wrap\"> <a class=\"action\" href=\"/movie/zodiac\">Summary</a> </span> </span> </li> <li class=\"nav nav_critic_reviews active_nav\"> <span class=\"nav_item\"> <span class=\"nav_item_wrap\"> <span class=\"action\">Critic Reviews</span> </span> </span> </li> <li class=\"nav nav_user_reviews\"> <span class=\"nav_item\"> <span class=\"nav_item_wrap\"> <a class=\"action\" href=\"/movie/zodiac/user-reviews\">User Reviews</a> </span> </span> </li> <li class=\"nav nav_details\"> <span class=\"nav_item\"> <span class=\"nav_item_wrap\"> <a class=\"action\" href=\"/movie/zodiac/details\">Details &amp; Credits</a> </span> </span> </li> <li class=\"nav nav_trailers last_nav\"> <span class=\"nav_item\"> <span class=\"nav_item_wrap\"> <a class=\"action\" href=\"/movie/zodiac/trailers\">Trailers &amp; Videos</a> </span> </span> </li> </ul> </div> <div class=\"module score_details_module\"><div class=\"score_details metascore_details\"> <div class=\"score_summary metascore_summary\"> <div class=\"metascore_wrap feature_metascore\"> <div class=\"label\">Metascore</div> <a class=\"metascore_anchor\" href=\"/movie/zodiac/critic-reviews\" rel=\"nofollow\"> <div class=\"metascore_w large movie positive\"><meta itemprop=\"bestRating\" content=\"100\"><span itemprop=\"ratingValue\">78</span></div> </a> <div class=\"summary\"> <p> <span class=\"desc\"> Generally favorable reviews </span> <span class=\"count\"> <span class=\"separator\"> - </span> <span class=\"based\">based on</span> <strong> 40 Critics </strong> </span> </p> </div> </div> </div> <div class=\"score_distribution\"> <div class=\"distribution_wrap\"> <div class=\"distribution_title\">Critic score distribution:</div> <ol class=\"score_counts\"> <li class=\"score_count\"> <div class=\"count_wrap\"> <span class=\"label\">Positive:</span> <span class=\"data\"> <a href=\"/movie/zodiac/critic-reviews?dist=positive\"> <span class=\"total\" style=\"width:100%;\"> <span class=\"count\">35</span> <span class=\"distribution positive\"> out of 40</span> </span> </a> </span> </div> </li> <li class=\"score_count\"> <div class=\"count_wrap\"> <span class=\"label\">Mixed:</span> <span class=\"data\"> <a href=\"/movie/zodiac/critic-reviews?dist=neutral\"> <span class=\"total\" style=\"width:14%;\"> <span class=\"count\">5</span> <span class=\"distribution mixed\"> out of 40</span> </span> </a> </span> </div> </li> <li class=\"score_count\"> <div class=\"count_wrap\"> <span class=\"label\">Negative:</span> <span class=\"data\"> <span class=\"total zero_total\" style=\"width:0%;\"> <span class=\"count\">0</span> <span class=\"distribution negative\"> out of 40</span> </span> </span> </div> </li> </ol> </div> </div> </div> </div> <div class=\"amazon_wrapper critic_reviews\"> <a rel=\"nofollow\" class=\"amazon_buy\" href=\"http://www.amazon.com/dp/B000VK7KVQ%3FSubscriptionId%3DAKIAJHSMUOWEQCQ7QDAQ%26tag%3Dmetacritic_aiv_product-20%26linkCode%3Dxm2%26camp%3D2025%26creative%3D165953%26creativeASIN%3DB000VK7KVQ\" target=\"_blank\" data-leadtype=\"Digital Product\" data-leadtag=\"metacritic_aiv_product-20\" data-leadid=\"1\" data-leadname=\"amazon\" data-leadplace=\"upper body\"> <img src=\"/images/buttons/amazon-iv-yellow.png\" title=\"Watch Now with Amazon Instant Video\"> </a> </div> <script type=\"text/javascript\"> window.eventAmazonBuyView = true; </script> <div class=\"module reviews_module critic_reviews_module\"> <div class=\"body product_reviews\"> <div class=\"tabs \"> <div class=\"tab_wrap\"> <ul class=\"tabs tabs_type_1\"> <li class=\"tab tab_type_1 tab_sort-critic-score first\"> <span class=\"active\"><span>Critic Score</span></span> </li> <li class=\"tab tab_type_1 tab_sort-most-active\"> <a href=\"/movie/zodiac/critic-reviews?sort-by=most-active&amp;num_items=100\"><span>Most active</span></a> </li> <li class=\"tab tab_type_1 tab_sort-publication\"> <a href=\"/movie/zodiac/critic-reviews?sort-by=publication&amp;num_items=100\"><span>Publication</span></a> </li> <li class=\"tab tab_type_1 tab_sort-most-clicked last\"> <a href=\"/movie/zodiac/critic-reviews?sort-by=most-clicked&amp;num_items=100\"><span>Most clicked</span></a> </li> </ul> <div class=\"tab_options_wrap\"> <div class=\"page_nav_options\"> <div class=\"options_wrap\"> <div class=\"label\">view</div> <div class=\"options\"> <ul class=\"options\"> <li class=\"option\"> <a href=\"/movie/zodiac/critic-reviews?num_items=30\"><span>30</span></a> </li> <li class=\"option\"> <span>100</span> </li> </ul> </div> <div class=\"desc\">per page</div> </div> </div> </div> </div> </div> <ol class=\"reviews critic_reviews\"> <li class=\"review critic_review first_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/chicago-sun-times?filter=movies\">Chicago Sun-Times</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/roger-ebert?filter=movies\">Roger Ebert</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv perfect\">100</div> </div> </div> <div class=\"review_body\"> Its most impressive accomplishment is to gather a bewildering labyrinth of facts and suspicions over a period of years, and make the journey through this maze frightening and suspenseful. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/roger-ebert?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://rogerebert.suntimes.com/apps/pbcs.dll/article?AID=/20070823/REVIEWS/708230308\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/tv-guide?filter=movies\">TV Guide</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/maitland-mcdonagh?filter=movies\">Maitland McDonagh</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv perfect\">100</div> </div> </div> <div class=\"review_body\"> Fincher gets it all right, and Donovan's hippie-dippy \"Hurdy Gurdy Man,\" which bookends the story, has never sounded so hauntingly menacing. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/maitland-mcdonagh?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://tvguide.com/detail/movie.aspx?tvobjectid=286668&amp;more=ucmoviereview\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/entertainment-weekly?filter=movies\">Entertainment Weekly</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/owen-gleiberman?filter=movies\">Owen Gleiberman</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv perfect\">100</div> </div> </div> <div class=\"review_body\"> Zodiac never veers from its stoically gripping, police-blotter tone, yet it begins to take on the quality of a dream. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/owen-gleiberman?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.ew.com/ew/article/0,,20013552,00.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic\"><div class=\"source\"><a href=\"/publication/village-voice?filter=movies\">Village Voice</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><span class=\"no_link\">Nathan Lee</span></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv perfect\">100</div> </div> </div> <div class=\"review_body\"> Zodiac exhausts more than one genre. Termite art par excellence, it burrows for the sake of burrowing, as fascinated by its own nooks and crannies as \"Inland Empire.\" </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/publication/village-voice?filter=movies\">All this publication's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.villagevoice.com/film/0709,lee,75891,20.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/the-av-club?filter=movies\">The A.V. Club</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/scott-tobias?filter=movies\">Scott Tobias</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv perfect\">100</div> </div> </div> <div class=\"review_body\"> Zodiac is the rare serial-killer movie in which the psychosis stems as much from the pursuers (and the filmmaker) as the pursued. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/scott-tobias?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.avclub.com/content/node/59208\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/seattle-post-intelligencer?filter=movies\">Seattle Post-Intelligencer</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/william-arnold?filter=movies\">William Arnold</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">91</div> </div> </div> <div class=\"review_body\"> An absorbing and fulfilling experience -- even though it ends with a question mark. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/william-arnold?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://seattlepi.nwsource.com/movies/305698_zodiac02q.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/christian-science-monitor?filter=movies\">Christian Science Monitor</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/peter-rainer?filter=movies\">Peter Rainer</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">91</div> </div> </div> <div class=\"review_body\"> In Zodiac, working from a script by James Vanderbilt, Fincher has decidedly toned down his act. His straight-ahead, methodical direction isn't as flagrantly unsettling as much of his previous work, but it's more psychologically layered. In this film, for the first time, we feel for his characters when they bleed. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/peter-rainer?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.csmonitor.com/2007/0302/p14s01-almo.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/the-hollywood-reporter?filter=movies\">The Hollywood Reporter</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/michael-rechtshaffen?filter=movies\">Michael Rechtshaffen</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">90</div> </div> </div> <div class=\"review_body\"> Firing on all cylinders as a creepy thriller, police procedural and \"All the President's Men\"-style investigative newsroom drama, the smart, extremely vivid production oozes period authenticity. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/michael-rechtshaffen?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.hollywoodreporter.com/hr/film/reviews/article_display.jsp?JSESSIONID=FhLbkPbngG4Fj8Xgjyp2pplpn1mZr7yGknTklFvv2vrYwh7nhHG8!-1407640441&amp;&amp;rid=8842\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/la-weekly?filter=movies\">L.A. Weekly</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/scott-foundas?filter=movies\">Scott Foundas</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">90</div> </div> </div> <div class=\"review_body\"> Zodiac may be the perfect meeting of filmmaker and subject ­-- an obsessive's portrait of obsession that is, finally, a monument to irresolution. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/scott-foundas?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.laweekly.com/film+tv/film/collateral-damage/15766/\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/the-new-york-times?filter=movies\">The New York Times</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/manohla-dargis?filter=movies\">Manohla Dargis</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">90</div> </div> </div> <div class=\"review_body\"> Rarely has a film with so much blood on its hands seemed so insistently alive. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/manohla-dargis?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://movies2.nytimes.com/2007/03/02/movies/02zodi.html?ref=movies\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/time?filter=movies\">Time</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/richard-corliss?filter=movies\">Richard Corliss</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">90</div> </div> </div> <div class=\"review_body\"> Fincher, whose work on \"Fight Club\" and \"Panic Room\" displayed his expertise in melding the suspenseful and the lurid, plays it cool here. He lets his stars do their thing. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/richard-corliss?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.time.com/time/magazine/article/0,9171,1595237,00.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/variety?filter=movies\">Variety</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/todd-mccarthy?filter=movies\">Todd McCarthy</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">90</div> </div> </div> <div class=\"review_body\"> Conveying an astonishing array of information across a long narrative arc while still maintaining dramatic rhythm and tension, this adaptation of Robert Graysmith's bestseller reps by far director David Fincher's most mature and accomplished work. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/todd-mccarthy?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.variety.com/review/VE1117932879.html?categoryid=31&amp;cs=1\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/rolling-stone?filter=movies\">Rolling Stone</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/peter-travers?filter=movies\">Peter Travers</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> Unique and unmissable. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/peter-travers?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.rollingstone.com/reviews/movie/9459749/review/13643154/zodiac\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/chicago-tribune?filter=movies\">Chicago Tribune</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/michael-phillips?filter=movies\">Michael Phillips</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> It's fascinating and unexpected both in its simple, looming images and its storytelling priorities, which may not intersect with the priorities of audiences who couldn't get enough of \"Se7en.\" </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/michael-phillips?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://metromix.chicagotribune.com/movies/mmx-070302-movies-review-zodiac,0,1934131.story?coll=mmx-movies_top_heds\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/new-york-post?filter=movies\">New York Post</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/lou-lumenick?filter=movies\">Lou Lumenick</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> This movie sends you into the night thinking, maybe even a little afraid. Bravo, Mr. Fincher. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/lou-lumenick?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.nypost.com/seven/03012007/entertainment/movies/horrorscope_movies_lou_lumenick.htm\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/philadelphia-inquirer?filter=movies\">Philadelphia Inquirer</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/carrie-rickey?filter=movies\">Carrie Rickey</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> Zodiac is a reproach both to those dedicated to unscrambling \"The Da Vinci Code\" and to those hooked on forensic crime shows where all the evidence leads to a tidy conclusion. That Zodiac's manhunt is inconclusive makes it all the more haunting. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/carrie-rickey?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://ae.philly.com/entertainment/ui/philly/movie.html?id=825844&amp;reviewId=22298\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/usa-today?filter=movies\">USA Today</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/claudia-puig?filter=movies\">Claudia Puig</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> This is the rare movie that blends long scenes of meticulous research with a sweeping story and sustains a feeling of riveting suspense. Zodiac grips you by the throat and doesn't let go. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/claudia-puig?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.usatoday.com/life/movies/reviews/2007-03-01-zodiac-review_x.htm\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/premiere?filter=movies\">Premiere</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/glenn-kenny?filter=movies\">Glenn Kenny</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> It makes for a daringly different kind of thriller -- cerebral, meticulous, haunting. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/glenn-kenny?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.premiere.com/moviereviews/3561/zodiac.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/charlotte-observer?filter=movies\">Charlotte Observer</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/lawrence-toppman?filter=movies\">Lawrence Toppman</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">88</div> </div> </div> <div class=\"review_body\"> Anyone who enjoys the novels of Ed McBain, the Oscar-winning \"All the President's Men\" or any televised variation of \"CSI\" will be at home here. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/lawrence-toppman?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://ae.charlotte.com/entertainment/ui/charlotte/movie.html?id=825844&amp;reviewId=22297&amp;startDate=NEXT7\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/portland-oregonian?filter=movies\">Portland Oregonian</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/shawn-levy?filter=movies\">Shawn Levy</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">83</div> </div> </div> <div class=\"review_body\"> It doesn't break ground like \"Seven\" or \"Fight Club\"; it's not a thrill ride like \"Panic Room.\" But it's a mature, thoughtful and full-bodied movie that compensates for the demands it makes with the rewards of craftsmanship, rigor, skill and art. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/shawn-levy?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.oregonlive.com/movies/oregonian/index.ssf?/base/entertainment/117270511613700.xml&amp;coll=7\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/baltimore-sun?filter=movies\">Baltimore Sun</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/michael-sragow?filter=movies\">Michael Sragow</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">83</div> </div> </div> <div class=\"review_body\"> Like Brian De Palma's 1981 masterpiece \"Blow-Out,\" this movie contains cutting perceptions of obsession, institutional and professional myopia, misplaced loyalty in experts, misreadings of evidence and the kind of confusion that leads to conspiracy theories. But Fincher's movie falls short of masterpiece status. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/michael-sragow?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.baltimoresun.com/entertainment/movies/bal-to.zodiac02mar02,0,1731886.story?coll=bal-artslife-movies\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/film-threat?filter=movies\">Film Threat</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/pete-vonder-haar?filter=movies\">Pete Vonder Haar</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">80</div> </div> </div> <div class=\"review_body\"> The more unpleasant aspects of the case are minimized in favor of telling the story and highlighting the effects of the case on these four men. It drags in spots, but even if Fincher hasn't hit it out of the park, Zodiac is easily a stand-up triple. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/pete-vonder-haar?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.filmthreat.com/index.php?section=reviews&amp;Id=9804\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/empire?filter=movies\">Empire</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/kim-newman?filter=movies\">Kim Newman</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">80</div> </div> </div> <div class=\"review_body\"> This gripping character study becomes more agonisingly suspenseful as it gets closer to an answer that can't be confirmed. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/kim-newman?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.empireonline.com/reviews/review.asp?FID=11066\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/newsweek?filter=movies\">Newsweek</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/david-ansen?filter=movies\">David Ansen</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">80</div> </div> </div> <div class=\"review_body\"> The movie holds you in its grip from start to finish. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/david-ansen?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.msnbc.msn.com/id/17300647/site/newsweek/\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic\"><div class=\"source\"><a href=\"/publication/slate?filter=movies\">Slate</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><span class=\"no_link\">Dana Stevens</span></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">80</div> </div> </div> <div class=\"review_body\"> To undertake a thriller of this length and scope with no prospect of a morally satisfying resolution, Fincher must have been a little nuts himself. We'll see whether audiences used to the tidy one-hour cases on \"CSI\" and \"Law &amp; Order\" will follow him down Zodiac's murky, twisted, and ultimately dead-end street. It may not sound like it from that description, but it's a hell of a ride. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/publication/slate?filter=movies\">All this publication's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.slate.com/id/2160960/fr/flyout\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/the-new-yorker?filter=movies\">The New Yorker</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/david-denby?filter=movies\">David Denby</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">80</div> </div> </div> <div class=\"review_body\"> Zodiac is superbly made, but it's also a strange piece of work. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/david-denby?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.newyorker.com/arts/critics/cinema/2007/03/19/070319crci_cinema_denby?currentPage=2\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/miami-herald?filter=movies\">Miami Herald</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/rene-rodriguez?filter=movies\">Rene Rodriguez</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">75</div> </div> </div> <div class=\"review_body\"> The straightforward approach is crucial, because the movie is constantly doling out so much information -- so many names and places and theories to keep track of -- that it borders on the overwhelming. Occasionally, it's a little dull, too. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/rene-rodriguez?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://ae.miami.com/entertainment/ui/miami/movie.html?id=825844&amp;reviewId=22304\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/boston-globe?filter=movies\">Boston Globe</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/wesley-morris?filter=movies\">Wesley Morris</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">75</div> </div> </div> <div class=\"review_body\"> Zodiac is a kind of corrective remake of \"Se7en,\" a renunciation of that earlier movie's psychotic nihilism. That rejection extends to a neat sight gag. Fincher gives us a shot of a cardboard cutout for \"Dirty Harry\" that mocks the personal abyss that catching Zodiac becomes. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/wesley-morris?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.boston.com/movies/display?display=movie&amp;id=8908\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/reelviews?filter=movies\">ReelViews</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/james-berardinelli?filter=movies\">James Berardinelli</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">75</div> </div> </div> <div class=\"review_body\"> The length and uneven pacing are stumbling blocks with which an audience must contend. Patient viewers will be rewarded; others may wish for something with less subtlety and more verve. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/james-berardinelli?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.reelviews.net/movies/z/zodiac.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/the-globe-and-mail-toronto?filter=movies\">The Globe and Mail (Toronto)</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/liam-lacey?filter=movies\">Liam Lacey</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">75</div> </div> </div> <div class=\"review_body\"> The most provocative aspect of this compulsive riddle is how it resists closure. The end comes not when we have the answer, but when the movie reaches its irresolute end. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/liam-lacey?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.theglobeandmail.com/servlet/story/RTGAM.20070301.wzodiac02/BNStory/Entertainment/home\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/new-york-magazine-vulture?filter=movies\">New York Magazine (Vulture)</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/david-edelstein?filter=movies\">David Edelstein</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">70</div> </div> </div> <div class=\"review_body\"> What begins like your basic police procedural becomes more and more choppy and diffuse. To a point, that’s intentional: Zodiac was never caught, and Fincher aims to creep you out with the lack of closure. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/david-edelstein?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://nymag.com/movies/reviews/28516/\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/los-angeles-times?filter=movies\">Los Angeles Times</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/kevin-crust?filter=movies\">Kevin Crust</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">70</div> </div> </div> <div class=\"review_body\"> Zodiac is primarily a complex character study, despite the film's grim and gruesome subject matter. It's a role reversal of sorts for a director who normally emphasizes the brutal tension in his movies. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/kevin-crust?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.calendarlive.com/printedition/calendar/cl-et-zodiac2mar02,0,3238013.story\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/the-new-republic?filter=movies\">The New Republic</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/stanley-kauffmann?filter=movies\">Stanley Kauffmann</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">70</div> </div> </div> <div class=\"review_body\"> The picture tries hard for addictive mystery, but it is full of scenes that promise insight and don't deliver. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/stanley-kauffmann?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.tnr.com/doc.mhtml?i=20070402&amp;s=kauffmann040207\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/austin-chronicle?filter=movies\">Austin Chronicle</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/marjorie-baumgarten?filter=movies\">Marjorie Baumgarten</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">67</div> </div> </div> <div class=\"review_body\"> At 2 1/2 hours, the film is too long in the telling and too short on suspense. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/marjorie-baumgarten?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.austinchronicle.com/gyrobase/Calendar/Film?Film=oid%3A450672\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/new-york-daily-news?filter=movies\">New York Daily News</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/jack-mathews?filter=movies\">Jack Mathews</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie positive indiv\">63</div> </div> </div> <div class=\"review_body\"> Without a persuasive ending, Zodiac is an exercise in frustration if not futility. But before it hits the inevitable wall, it does something better than most genre films even attempt: it perfectly depicts the obsession that often overtakes cops and reporters involved in high-profile crimes. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/jack-mathews?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.nydailynews.com/entertainment/movies/moviereviews/story/501874p-423220c.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/san-francisco-chronicle?filter=movies\">San Francisco Chronicle</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/mick-lasalle?filter=movies\">Mick LaSalle</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie mixed indiv\">50</div> </div> </div> <div class=\"review_body\"> Never takes off, but it never collapses. At times, it becomes frustrating -- for example, about 30 minutes are spent pursuing a lead that goes nowhere. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/mick-lasalle?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.sfgate.com/cgi-bin/article.cgi?f=/c/a/2007/03/02/DDG94OD7F11.DTL&amp;type=movies\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/saloncom?filter=movies\">Salon.com</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/stephanie-zacharek?filter=movies\">Stephanie Zacharek</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie mixed indiv\">50</div> </div> </div> <div class=\"review_body\"> Bits of the picture are fascinating to look at, but eventually, exhaustion kicks in, to the point where we're not sure what we're looking at, or why. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/stephanie-zacharek?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.salon.com/ent/movies/review/2007/03/02/zodiac/index.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/wall-street-journal?filter=movies\">Wall Street Journal</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/joe-morgenstern?filter=movies\">Joe Morgenstern</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie mixed indiv\">50</div> </div> </div> <div class=\"review_body\"> The film feels self-obsessed, an intriguing drama that slowly devolves into a bleak meditation on the absence of dramatics. </div> </div> <div class=\"review_section review_actions\"> <div class=\"review_action author_reviews\"><a href=\"/critic/joe-morgenstern?filter=movies\">All this critic's reviews</a></div> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/washington-post?filter=movies\">Washington Post</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/stephen-hunter?filter=movies\">Stephen Hunter</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie mixed indiv\">50</div> </div> </div> <div class=\"review_body\"> That's exactly the problem with this movie: It's not about a killer, or his victims, or the manhunt or the cops. They're all in it, of course, more or less. But it's about a writer. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/stephen-hunter?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://www.washingtonpost.com/ac2/wp-dyn?node=cityguide/profile&amp;id=1124969&amp;categories=Movies&amp;nm=1\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> <li class=\"review critic_review last_review\"> <div class=\"review_btm review_btm_r\"><div class=\"review_btm review_btm_l\"><div class=\"review_top review_top_r\"><div class=\"review_top review_top_l\"> <div class=\"review_content\"> <div class=\"review_section\"> <div class=\"review_stats\"> <div class=\"review_critic has_author\"><div class=\"source\"><a href=\"/publication/chicago-reader?filter=movies\">Chicago Reader</a></div><div class=\"author\"><span class=\"label\"><span class=\"text\">Reviewed by:</span>&nbsp;</span><a href=\"/critic/jonathan-rosenbaum?filter=movies\">Jonathan Rosenbaum</a></div></div> <div class=\"review_grade has_author\"> <div class=\"metascore_w medium movie mixed indiv\">50</div> </div> </div> <div class=\"review_body\"> In some ways, for better and for worse, this is even more about Graysmith (Jake Gyllehaal)--who became obsessed with solving the Zodiac killings that terrorized northern California in the late 60s--than about the murderer. </div> </div> <div class=\"review_section review_actions\"> <ul class=\"review_actions\"> <li class=\"review_action author_reviews\"><a href=\"/critic/jonathan-rosenbaum?filter=movies\">All this critic's reviews</a></li> <li class=\"review_action full_review\"><a rel=\"popup:external\" class=\"external\" href=\"http://onfilm.chicagoreader.com/movies/briefs/31171_ZODIAC.html\" target=\"_blank\">Read full review</a></li> </ul> </div> </div> </div></div></div></div> </li> </ol> </div> </div> </div>";
	private static final int NYT_SCORE_WEIGHT = 1_000;

	ScoresProvider dataSource;
	private JsoupConnection connection;

	@Inject
	public MetacriticScores(JsoupConnection connection) {
		this.connection = connection;
		dataSource = new GoogleScores(connection,  "metacritic");
	}
	
	@Override
	public Stream<Score> scoresOf(Description description) {

		Optional<Element> htmlWithScores = metacriticSummaryOf(description.titleAsText(), description.getYear())
				.flatMap(MetacriticSelectors.LINK_TO_DETAILS::extractFrom)
				.flatMap(href -> downloadPage(METACRITIC_BASE_URL + href))
				.flatMap(MetacriticSelectors.LINK_TO_CRITIC_REVIEWS::extractFrom)
				.flatMap(href -> downloadPage(METACRITIC_BASE_URL + href))
				.map(page -> page.select("#main").first());

		Stream<Score> averageScoreStream = htmlWithScores
				.flatMap(htmlContent -> averageGradeFrom(htmlContent)
						.map(grade -> new Score(grade, numberOfReviewsFrom(htmlContent))))
				.map(Stream::of).orElseGet(Stream::empty);

		Stream<Score> nytScoreStream = htmlWithScores
				.flatMap(htmlContent -> nytScoreFrom(htmlContent))
				.map(Stream::of).orElseGet(Stream::empty);

		return Stream.concat(
				averageScoreStream,
				nytScoreStream
		);

	}

	Optional<Double> averageGradeFrom(Element htmlWithScores) {
		return MetacriticSelectors.AVERAGE_GRADE.extractFrom(htmlWithScores)
				.map(Double::valueOf)
				.map(d -> d / 100.0);
	}
	
	int numberOfReviewsFrom(Element htmlWithScores) {
		return MetacriticSelectors.NUMBER_OF_GRADES.extractFrom(htmlWithScores)
				.map(Integer::valueOf)
				.orElseThrow(() -> new MissingValueException(htmlWithScores.text()));
	}
	
	Optional<Score> nytScoreFrom(Element htmlWithScores) {
		return MetacriticSelectors.NEW_YORK_TIMES_GRADE.extractFrom(htmlWithScores)
				.map(grade -> (Double.valueOf(grade) / 100.0))
				.map(percentage -> new Score(percentage, NYT_SCORE_WEIGHT));
	}
	
	private Optional<Element> downloadPage(String url) {
		return connection.connectToAndGet(url);
	}

	Optional<Element> metacriticSummaryOf(String title, int year) {
		String searchUrl;
		try {
			searchUrl = String.format(
					METACRITIC_BASE_URL + "/search/movie/%s/results", 
					URLEncoder.encode(title, Charsets.UTF_8.toString()));
		} catch (UnsupportedEncodingException e) {
			throw new RuntimeException(e);
		}
		
		try {
			return downloadPage(searchUrl)
					.flatMap(page -> MetacriticStreamSelectors.SEARCH_RESULTS.extractFrom(page)
							.filter(e -> MetacriticSelectors.TITLE.extractFrom(e)
											.filter(t -> t.equalsIgnoreCase(title))
											.isPresent()
							)
							.filter(e -> MetacriticSelectors.RELEASE_DATE.extractFrom(e)
											.filter(date -> date.endsWith(String.valueOf(year)))
											.isPresent()
							)
							.findFirst());
		} catch (Exception e) {
			e.printStackTrace();
			return Optional.empty();
		}
	}
	
	public static void main(String[] args) {
		
		
		MetacriticScores scores = new MetacriticScores(new JsoupCachedConnection(CacheProvider.empty()));
		
		Description description = Description.builder()
				.title(Title.builder().title("Citizenfour").originalTitle("Citizenfour").year(2014).build())
				.build();
		scores.scoresOf(description).forEach(System.out::println);
	}
}
